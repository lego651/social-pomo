(window["webpackJsonpsocial-pomo"]=window["webpackJsonpsocial-pomo"]||[]).push([[0],{109:function(e,t,a){},110:function(e,t,a){},123:function(e,t,a){},124:function(e,t,a){},125:function(e,t,a){},126:function(e,t,a){},127:function(e,t,a){},129:function(e,t,a){},130:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),o=a(12),c=a.n(o),i=a(20),s=a(39),l=a(36),u=a(21),d=a.n(u),m=(a(106),a(68)),p=a.n(m),h=(a(109),a(15)),f=a(13),b=a(17),E=a(18),y=a(19),v=a(16),g=a(155),O=a(156),j=a(70),w=a(161),S=a(163),C=function(e){var t="Bearer ".concat(e);localStorage.setItem("FBIdToken",t),d.a.defaults.headers.common.Authorization=t},I=function(){return function(e){e({type:"LOADING_USER"}),d.a.get("/user").then((function(t){e({type:"SET_USER",payload:t.data})})).catch((function(e){return console.log(e)}))}},k=function(){return function(e){localStorage.removeItem("FBIdToken"),delete d.a.defaults.headers.common.Authorization,e({type:"SET_UNAUTHENTICATED"}),window.location.href="/login"}},R={LOG_IN:"LOG_IN",GET_MESSAGES:"GET_MESSAGES"},P=(a(110),function(e){function t(e){var a;return Object(h.a)(this,t),(a=Object(b.a)(this,Object(E.a)(t).call(this,e))).handleChange=function(e){a.setState(Object(v.a)({},e.target.name,e.target.value))},a.handleSubmit=function(e){e.preventDefault();var t={email:a.state.email,password:a.state.password};a.props.loginUser(t,a.props.history)},a.state={email:"",password:"",errors:{}},a}return Object(y.a)(t,e),Object(f.a)(t,[{key:"componentWillReceiveProps",value:function(e){e.UI.errors&&this.setState({errors:e.UI.errors})}},{key:"render",value:function(){var e=this,t=this.state.errors;return r.a.createElement("div",{className:"login-container"},r.a.createElement(g.a,null,r.a.createElement(O.a,null,r.a.createElement(j.a,null," "),r.a.createElement(j.a,{md:6,xs:12},r.a.createElement("div",{className:"signup-form"},r.a.createElement(w.a,{onSubmit:function(t){e.handleSubmit(t)}},r.a.createElement(w.a.Group,{controlId:"formBasicEmail"},r.a.createElement(w.a.Label,null,"Email address"),r.a.createElement(w.a.Control,{type:"email",placeholder:"Enter email",name:"email",onChange:function(t){e.handleChange(t)},isInvalid:!!t.email}),r.a.createElement(w.a.Control.Feedback,{type:"invalid"},t.email)),r.a.createElement(w.a.Group,{controlId:"formBasicPassword"},r.a.createElement(w.a.Label,null,"Password"),r.a.createElement(w.a.Control,{type:"password",placeholder:"Password",name:"password",onChange:function(t){e.handleChange(t)},isInvalid:!!t.password}),r.a.createElement(w.a.Control.Feedback,{type:"invalid"},t.password)),r.a.createElement(S.a,{variant:"primary",type:"submit"},"Log In")))),r.a.createElement(j.a,null," "))))}}]),t}(n.Component)),U=Object(i.b)((function(e){return{user:e.user,UI:e.UI}}),{loginUser:function(e,t){return function(a){a({type:"LOADING_UI"}),d.a.post("/login",e).then((function(e){C(e.data.token),a(I()),a({type:"CLEAR_ERRORS"}),t.push("/room")})).catch((function(e){console.log(e),a({type:"SET_ERRORS",payload:e.response.data})}))}}})(P),_=a(162),D=a(48);a(122);D.initializeApp({apiKey:"AIzaSyBuRc03LvtY55WHAkzyUfaNInvRPsp5Enc",authDomain:"social-pomo-94112.firebaseapp.com",databaseURL:"https://social-pomo-94112.firebaseio.com",projectId:"social-pomo-94112",storageBucket:"social-pomo-94112.appspot.com",messagingSenderId:"105418250972"}),D.firestore().settings({timestampsInSnapshots:!0});var A=D,T=(a(123),function(e){function t(e){var a;return Object(h.a)(this,t),(a=Object(b.a)(this,Object(E.a)(t).call(this,e))).subscribeReadyCount=function(e){a.setState({readyCount:e.data().readyCount}),2===e.data().readyCount&&a.handleStart(),0===e.data().readyCount&&a.handleReset()},a.ref=A.firestore().collection("meta").doc("us"),a.unsubsrcibe=null,a.state={sec:10,ready:!1,readyCount:0,on:!1},a}return Object(y.a)(t,e),Object(f.a)(t,[{key:"count",value:function(){this.state.on?this.state.sec>0&&this.setState((function(e){return{sec:e.sec-1}})):this.setState({sec:0,on:!1})}},{key:"handleStart",value:function(){var e=this;this.setState({on:!0}),this.interval=setInterval((function(){e.count()}),1e3)}},{key:"handleReset",value:function(){this.setState({sec:10,on:!1}),clearInterval(this.interval)}},{key:"getReady",value:function(){var e=this;d.a.get("/readyaddone").then((function(t){e.setState({ready:!0})})).catch((function(e){console.log(e)}))}},{key:"getReset",value:function(){var e=this;d.a.get("/readyminusone").then((function(t){e.setState({ready:!1})})).catch((function(e){console.log(e)}))}},{key:"componentDidMount",value:function(){this.unsubscribe=this.ref.onSnapshot(this.subscribeReadyCount)}},{key:"render",value:function(){var e,t=this;return console.log(this.state.readyCount),r.a.createElement("div",{className:"pomodoro-container"},r.a.createElement("h2",null," ",(e=this.state.sec,Math.floor(e/60)+" : "+Math.round(e%60))," "),0===this.state.readyCount?r.a.createElement(_.a,{variant:"contained",color:"primary",onClick:function(){t.getReady()}},"Ready!"):1===this.state.readyCount?this.state.on&&this.state.ready?r.a.createElement(_.a,{variant:"contained",color:"primary",onClick:function(){t.getReset()}},"Continue"):0!=this.state.on||this.state.ready?r.a.createElement(_.a,{variant:"contained",color:"primary"},"Waiting..."):r.a.createElement(_.a,{variant:"contained",color:"primary",onClick:function(){t.getReady()}},"Ready!"):r.a.createElement(_.a,{variant:"contained",color:"primary",onClick:function(){t.getReset()}},"Continue"))}}]),t}(n.Component)),N=(a(124),a(160)),L=function(e){function t(e){var a;return Object(h.a)(this,t),(a=Object(b.a)(this,Object(E.a)(t).call(this,e))).onUpdateMessages=function(e){var t=[];e.forEach((function(e){t.push({userHandle:e.data().userHandle,content:e.data().content,createdAt:e.data().createdAt})})),a.setState({messages:t})},a.ref=A.firestore().collection("messages"),a.unsubscribe=null,a.state={messages:[],content:""},a}return Object(y.a)(t,e),Object(f.a)(t,[{key:"handleChange",value:function(e){this.setState(Object(v.a)({},e.target.name,e.target.value))}},{key:"handleSubmit",value:function(e){e.preventDefault();var t={userHandle:this.props.username,content:this.state.content};this.props.addMessage(t),this.setState({content:""})}},{key:"componentDidMount",value:function(){this.unsubscribe=this.ref.orderBy("createdAt").onSnapshot(this.onUpdateMessages)}},{key:"render",value:function(){var e=this;return r.a.createElement("div",{className:"chatroom-container"},this.state.messages.map((function(e){return r.a.createElement("div",{key:e.messageId}," ",e.content," ")})),r.a.createElement("div",{className:"chatroom-input"},r.a.createElement("form",{onSubmit:function(t){e.handleSubmit(t)}},r.a.createElement(N.a,{type:"text",name:"content",label:"content",onChange:function(t){e.handleChange(t)},value:this.state.content,fullWidth:!0}),r.a.createElement(_.a,{type:"submit",variant:"contained",color:"primary"},"Submit"))))}}]),t}(n.Component),G=Object(i.b)((function(e){return{username:e.user.profile.handle}}),(function(e){return{addMessage:function(t){return e(function(e){return function(t){d.a.post("/message",e).then((function(e){console.log(e)})).catch((function(e){console.log(e)}))}}(t))}}}))(L),B=(a(125),function(e){function t(){return Object(h.a)(this,t),Object(b.a)(this,Object(E.a)(t).apply(this,arguments))}return Object(y.a)(t,e),Object(f.a)(t,[{key:"render",value:function(){return r.a.createElement("div",{className:"room-container"},r.a.createElement(O.a,null,r.a.createElement(j.a,{md:6,sm:12},r.a.createElement(T,null)),r.a.createElement(j.a,{md:6,sm:12},r.a.createElement(G,null))))}}]),t}(n.Component));d.a.defaults.baseURL="https://us-central1-social-pomo-94112.cloudfunctions.net/api";var M=function(e){function t(){return Object(h.a)(this,t),Object(b.a)(this,Object(E.a)(t).apply(this,arguments))}return Object(y.a)(t,e),Object(f.a)(t,[{key:"render",value:function(){var e=this.props.username;return r.a.createElement("div",{className:"app-container"},e?r.a.createElement(B,null):r.a.createElement(U,null))}}]),t}(n.Component);Object(i.b)((function(e){return{username:e.auth.username}}))(M),Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var x=a(34),F=a(74);function H(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function W(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?H(a,!0).forEach((function(t){Object(v.a)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):H(a).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var z={authenticated:!1,loading:!1,profile:{}},X=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:z,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_AUTHENTICATED":return W({},e,{authenticated:!0});case"SET_UNAUTHENTICATED":return z;case R.LOG_IN:return W({},e,{username:t.username});case"SET_USER":return{authenticated:!0,loading:!1,profile:t.payload.profile};default:return e}};function J(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function V(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?J(a,!0).forEach((function(t){Object(v.a)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):J(a).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var K={messages:[]},Y=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:K,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case R.GET_MESSAGES:return V({},e,{messages:t.payload});default:return e}};function $(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function q(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?$(a,!0).forEach((function(t){Object(v.a)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):$(a).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var Q={loading:!1,errors:null},Z=Object(x.c)({user:X,room:Y,UI:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Q,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_ERRORS":return q({},e,{loading:!1,errors:t.payload});case"CLEAR_ERRORS":return q({},e,{loading:!1,errors:null});case"LOADING_UI":return q({},e,{loading:!0});case"STOP_LOADING_UI":return q({},e,{loading:!1});default:return e}}}),ee=Object(x.e)(Z,Object(x.d)(Object(x.a)(F.a),window.__REDUX_DEVTOOLS_EXTENSION__&&window.__REDUX_DEVTOOLS_EXTENSION__())),te=(a(126),function(e){function t(e){var a;return Object(h.a)(this,t),(a=Object(b.a)(this,Object(E.a)(t).call(this,e))).handleChange=function(e){a.setState(Object(v.a)({},e.target.name,e.target.value))},a.handleSubmit=function(e){e.preventDefault();var t={email:a.state.email,password:a.state.password,confirmPassword:a.state.confirmPassword,handle:a.state.handle};a.props.signupUser(t,a.props.history)},a.state={email:"",password:"",confirmPassword:"",handle:"",errors:{}},a}return Object(y.a)(t,e),Object(f.a)(t,[{key:"componentWillReceiveProps",value:function(e){e.UI.errors&&this.setState({errors:e.UI.errors})}},{key:"render",value:function(){var e=this,t=this.state.errors;return r.a.createElement("div",{className:"signup-container"},r.a.createElement(g.a,null,r.a.createElement(O.a,null,r.a.createElement(j.a,null," "),r.a.createElement(j.a,{md:6,xs:12},r.a.createElement("div",{className:"signup-form"},r.a.createElement(w.a,{onSubmit:function(t){e.handleSubmit(t)}},r.a.createElement(w.a.Group,{controlId:"formBasicEmail"},r.a.createElement(w.a.Label,null,"Email address"),r.a.createElement(w.a.Control,{type:"email",placeholder:"Enter email",name:"email",onChange:function(t){e.handleChange(t)},isInvalid:!!t.email}),r.a.createElement(w.a.Control.Feedback,{type:"invalid"},t.email)),r.a.createElement(w.a.Group,{controlId:"formBasicPassword"},r.a.createElement(w.a.Label,null,"Password"),r.a.createElement(w.a.Control,{type:"password",placeholder:"Password",name:"password",onChange:function(t){e.handleChange(t)},isInvalid:!!t.password}),r.a.createElement(w.a.Control.Feedback,{type:"invalid"},t.password)),r.a.createElement(w.a.Group,{controlId:"formBasicPassword"},r.a.createElement(w.a.Label,null,"Confirm Password"),r.a.createElement(w.a.Control,{type:"password",placeholder:"Confirm Password",name:"confirmPassword",onChange:function(t){e.handleChange(t)},isInvalid:!!t.confirmPassword}),r.a.createElement(w.a.Control.Feedback,{type:"invalid"},t.confirmPassword)),r.a.createElement(w.a.Group,{controlId:"formBasicEmail"},r.a.createElement(w.a.Label,null,"Username"),r.a.createElement(w.a.Control,{type:"text",placeholder:"Username",name:"handle",onChange:function(t){e.handleChange(t)},isInvalid:!!t.handle}),r.a.createElement(w.a.Control.Feedback,{type:"invalid"},t.handle)),r.a.createElement(S.a,{variant:"primary",type:"submit"},"Sign Up")))),r.a.createElement(j.a,null," "))))}}]),t}(n.Component)),ae=Object(i.b)((function(e){return{auth:e.auth,UI:e.UI}}),{signupUser:function(e,t){return function(a){a({type:"LOADING_UI"}),d.a.post("/signup",e).then((function(e){console.log(e),C(e.data.token),a(I()),a({type:"CLEAR_ERRORS"}),t.push("/room")})).catch((function(e){a({type:"SET_ERRORS",payload:e.response.data})}))}}})(te),ne=a(159),re=(a(127),function(e){function t(){return Object(h.a)(this,t),Object(b.a)(this,Object(E.a)(t).apply(this,arguments))}return Object(y.a)(t,e),Object(f.a)(t,[{key:"render",value:function(){return r.a.createElement("div",{className:"signup-container"},r.a.createElement(ne.a,{pill:!0,variant:"success"}," Home "),r.a.createElement(ne.a,{pill:!0,variant:"success"}," ",r.a.createElement(s.b,{to:"/room"}," Room ")," "),r.a.createElement(ne.a,{pill:!0,variant:"success"}," ",r.a.createElement(s.b,{to:"/signup"}," signup ")," "),r.a.createElement(ne.a,{pill:!0,variant:"success"}," ",r.a.createElement(s.b,{to:"/login"}," login ")," "),r.a.createElement(ne.a,{pill:!0,variant:"success"}," ",r.a.createElement(s.b,{to:"/profile"}," Profile ")," "))}}]),t}(n.Component)),oe=(a(129),function(e){function t(){var e,a;Object(h.a)(this,t);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(a=Object(b.a)(this,(e=Object(E.a)(t)).call.apply(e,[this].concat(r)))).handleClick=function(e){a.props.logoutUser()},a}return Object(y.a)(t,e),Object(f.a)(t,[{key:"render",value:function(){var e=this;return r.a.createElement("div",{className:"signup-container"},r.a.createElement(ne.a,{pill:!0,variant:"success"}," Profile "),this.props.user.profile.handle,r.a.createElement(S.a,{variant:"primary",onClick:function(){e.handleClick()}},"log out"))}}]),t}(n.Component)),ce=Object(i.b)((function(e){return{user:e.user,UI:e.UI}}),{logoutUser:k})(oe),ie=function(e){var t=function(t){function a(){return Object(h.a)(this,a),Object(b.a)(this,Object(E.a)(a).apply(this,arguments))}return Object(y.a)(a,t),Object(f.a)(a,[{key:"componentDidMount",value:function(){this._checkAndRedirect()}},{key:"componentDidUpdate",value:function(){this._checkAndRedirect()}},{key:"_checkAndRedirect",value:function(){var e=this.props,t=e.authenticated;e.redirect;console.log("1 is called..."),t||(console.log("2 is called..."),this.props.redirect())}},{key:"render",value:function(){return r.a.createElement("div",null,this.props.authenticated?r.a.createElement(e,this.props):null)}}]),a}(r.a.Component);return Object(i.b)((function(e){return{authenticated:e.user.authenticated}}),(function(e){return{redirect:function(){window.location.href="/login"}}}))(t)};d.a.defaults.baseURL="https://us-central1-social-pomo-94112.cloudfunctions.net/api";var se=localStorage.FBIdToken;se&&(1e3*p()(se).exp<Date.now()?(ee.dispatch(k()),window.location.href="/login"):(ee.dispatch({type:"SET_AUTHENTICATED"}),d.a.defaults.headers.common.Authorization=se,ee.dispatch(I())));c.a.render(r.a.createElement(i.a,{store:ee},r.a.createElement(s.a,null,r.a.createElement(l.c,null,r.a.createElement(l.a,{exact:!0,path:"/",component:re}),r.a.createElement(l.a,{exact:!0,path:"/signup",component:ae}),r.a.createElement(l.a,{exact:!0,path:"/login",component:U}),r.a.createElement(l.a,{exact:!0,path:"/profile",component:ie(ce)}),r.a.createElement(l.a,{exact:!0,path:"/room",component:ie(B)})))),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))},81:function(e,t,a){e.exports=a(130)}},[[81,1,2]]]);
//# sourceMappingURL=main.64eee922.chunk.js.map